import{RouterProvider as T,createRootRoute as j,Outlet as x,HeadContent as $,Scripts as C,createFileRoute as b,lazyRouteComponent as w,createRouter as F}from"@tanstack/react-router";import{jsx as d,jsxs as R}from"react/jsx-runtime";import{isPlainObject as E,encode as O,isRedirect as H,isNotFound as I}from"@tanstack/router-core";import{startSerializer as p,mergeHeaders as y,createServerFn as M}from"@tanstack/start-client-core";import{defineHandlerCallback as A,transformReadableStreamWithRouter as D,transformPipeableStreamWithRouter as N,getHeaders as G,getEvent as J,createStartHandler as z}from"@tanstack/start-server-core";import{createClient as L,createConfig as U}from"@hey-api/client-fetch";import W from"tiny-invariant";import{PassThrough as B}from"node:stream";import{isbot as g}from"isbot";import m from"react-dom/server";function _(e){return d(T,{router:e.router})}const K=A(async({request:e,router:t,responseHeaders:a})=>{if(typeof m.renderToReadableStream=="function"){const n=await m.renderToReadableStream(d(_,{router:t}),{signal:e.signal});g(e.headers.get("User-Agent"))&&await n.allReady;const r=D(t,n);return new Response(r,{status:t.state.statusCode,headers:a})}if(typeof m.renderToPipeableStream=="function"){const n=new B;try{const s=m.renderToPipeableStream(d(_,{router:t}),{...g(e.headers.get("User-Agent"))?{onAllReady(){s.pipe(n)}}:{onShellReady(){s.pipe(n)}},onError:(c,o)=>{console.error("Error in renderToPipeableStream:",c,o)}})}catch(s){console.error("Error in renderToPipeableStream:",s)}const r=N(t,n);return new Response(r,{status:t.state.statusCode,headers:a})}throw new Error("No renderToReadableStream or renderToPipeableStream found in react-dom/server. Ensure you are using a version of react-dom that supports streaming.")}),Q="/_build/assets/global-h3JjqrQt.css",h=j({head:()=>({meta:[{charSet:"utf-8"},{name:"viewport",content:"width=device-width, initial-scale=1"},{title:"Pokidex"}],links:[{rel:"stylesheet",href:Q}]}),component:X});function X(){return d(Z,{children:d(x,{})})}function Z({children:e}){return R("html",{lang:"en",children:[d("head",{children:d($,{})}),R("body",{children:[e,d(C,{})]})]})}async function V(e,t,a){var n;const r=t[0];if(E(r)&&r.method){const o=r,l=o.data instanceof FormData?"formData":"payload",u=new Headers({...l==="payload"?{"content-type":"application/json",accept:"application/json"}:{},...o.headers instanceof Headers?Object.fromEntries(o.headers.entries()):o.headers});if(o.method==="GET"){const i=O({payload:p.stringify({data:o.data,context:o.context})});i&&(e.includes("?")?e+=`&${i}`:e+=`?${i}`)}e.includes("?")?e+="&createServerFn":e+="?createServerFn",o.response==="raw"&&(e+="&raw");const v=await a(e,{method:o.method,headers:u,signal:o.signal,...Y(o)}),f=await S(v);if((n=f.headers.get("content-type"))!=null&&n.includes("application/json")){const i=p.decode(await f.json());if(H(i)||I(i)||i instanceof Error)throw i;return i}return f}const s=await S(await a(e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)})),c=s.headers.get("content-type");return c&&c.includes("application/json")?p.decode(await s.json()):s.text()}function Y(e){return e.method==="POST"?e.data instanceof FormData?(e.data.set("__TSR_CONTEXT",p.stringify(e.context)),{body:e.data}):{body:p.stringify({data:e.data??null,context:e.context})}:{}}async function S(e){if(!e.ok){const t=e.headers.get("content-type");throw t&&t.includes("application/json")?p.decode(await e.json()):new Error(await e.text())}return e}function q(e){return e.replace(/^\/|\/$/g,"")}const ee=(e,t)=>{const a=`/${q(t)}/${e}`;return Object.assign((...r)=>V(a,r,async(s,c)=>{c.headers=y(G(),c.headers);const o=await $fetch.native(s,c),l=J(),u=y(o.headers,l.___ssrRpcResponseHeaders);return l.___ssrRpcResponseHeaders=u,o}),{url:a,functionId:e})},te=()=>import("./index-Bj_3Fe14.js"),oe=ee("src_routes_index_tsx--getPokemonList_createServerFn_handler","/_server"),ne=M({method:"GET"}).handler(oe),k=b("/")({component:w(te,"component",()=>k.ssr),loader:async()=>await ne()}),re=L(U({baseUrl:"https://pokeapi.co"})),ae=e=>(e.client??re).get({security:[{in:"cookie",name:"sessionid",type:"apiKey"},{scheme:"basic",type:"http"}],url:"/api/v2/pokemon/{id}/",...e}),se=()=>import("./index-xrQiA1qM.js"),P=b("/pokemon/$pokemonId/")({component:w(se,"component",()=>P.ssr),loader:async({params:e})=>(await ae({path:{id:e.pokemonId}})).data}),ie=k.update({id:"/",path:"/",getParentRoute:()=>h}),ce=P.update({id:"/pokemon/$pokemonId/",path:"/pokemon/$pokemonId/",getParentRoute:()=>h}),de={IndexRoute:ie,PokemonPokemonIdIndexRoute:ce},pe=h._addFileChildren(de)._addFileTypes();function le(){return F({routeTree:pe,scrollRestoration:!0})}const me=()=>({routes:{__root__:{filePath:"__root.tsx",children:["/","/pokemon/$pokemonId/"],preloads:["/_build/assets/client-Dj4awSpZ.js","/_build/assets/client-BS5sCwGP.js"]},"/":{filePath:"index.tsx"},"/pokemon/$pokemonId/":{filePath:"pokemon/$pokemonId/index.tsx"}}});function ue(e){return globalThis.MANIFEST[e]}function fe(){const e=me(),t=e.routes.__root__=e.routes.__root__||{};t.assets=t.assets||[];let a="";const n=ue("client"),r=n.inputs[n.handler]?.output.path;return r||W(r,"Could not find client entry in vinxi manifest"),t.assets.push({tag:"script",attrs:{type:"module",suppressHydrationWarning:!0,async:!0},children:`${a}import("${r}")`}),e}function he(){const e=fe();return{...e,routes:Object.fromEntries(Object.entries(e.routes).map(([t,a])=>{const{preloads:n,assets:r}=a;return[t,{preloads:n,assets:r}]}))}}const Te=z({createRouter:le,getRouterManifest:he})(K);export{k as R,P as a,Te as h};
